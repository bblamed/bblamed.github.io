<script>
  // Matrix background effect
  const canvas = document.getElementById('matrix');
  const ctx = canvas.getContext('2d');
  let width = canvas.width = window.innerWidth;
  let height = canvas.height = window.innerHeight;

  const letters = 'アァイイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
  const fontSize = 18;
  const columns = Math.floor(width / fontSize);
  const drops = new Array(columns).fill(1);

  function draw() {
    ctx.fillStyle = 'rgba(0, 0, 0, 0.4)';
    ctx.fillRect(0, 0, width, height);
    ctx.fillStyle = 'rgba(0,255,0, 0.1)';
    ctx.font = fontSize + 'px monospace';

    for(let i = 0; i < drops.length; i++) {
      const text = letters[Math.floor(Math.random() * letters.length)];
      ctx.fillText(text, i * fontSize, drops[i] * fontSize);

      if(drops[i] * fontSize > height && Math.random() > 0.975) {
        drops[i] = 0;
      }
      drops[i]++;
    }
  }

  setInterval(draw, 50);

  window.addEventListener('resize', () => {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
  });

  // Hacker prank typing effect
  const consoleEl = document.getElementById('console');

  const hackerLines = [
    "Connecting to blockchain node...",
    "Mining block 0x7f3b21...",
    "Hash rate: 59.4 TH/s",
    "Verifying transactions...",
    "Found new block! Reward: 12.5 BTC",
    "Broadcasting to network...",
    "Updating ledger...",
    "Scanning for vulnerabilities...",
    "Decrypting secure channel...",
    "Injecting payload...",
    "Bypassing firewall...",
    "Extracting private keys...",
    "Encrypting data...",
    "Uploading to darknet...",
    "Establishing proxy connection...",
    "Spoofing IP address...",
    "Compiling malware...",
    "Uploading script to server...",
    "Accessing root privileges...",
    "Executing zero-day exploit..."
  ];

  let btcIndex = 0;

  function bitcoinMiner() {
    const line = hackerLines[btcIndex % hackerLines.length];
    consoleEl.textContent += "\n" + line;
    consoleEl.scrollTop = consoleEl.scrollHeight;
    btcIndex++;
    if (btcIndex > 200) {
      consoleEl.textContent = consoleEl.textContent.split('\n').slice(-100).join('\n');
    }
  }
  let minerInterval = setInterval(bitcoinMiner, 900);

  // Script typer
  const scriptLines = [
    "function exploit() {",
    "  while(true) {",
    "    injectPayload();",
    "  }",
    "}",
    "var backdoor = true;",
    "console.log('Access granted');",
    "executeCommand('sudo rm -rf /');",
    "setTimeout(hack, 3000);",
    "var keylogger = initKeylogger();"
  ];

  let currentScriptLine = '';
  let currentCharIndex = 0;
  let scriptActive = false;

  function typeScriptChar() {
    if (!scriptActive) return;

    if (currentCharIndex >= currentScriptLine.length) {
      currentScriptLine = scriptLines[Math.floor(Math.random() * scriptLines.length)];
      currentCharIndex = 0;
      consoleEl.textContent += "\n";
    }

    consoleEl.textContent += currentScriptLine.charAt(currentCharIndex);
    currentCharIndex++;
    consoleEl.scrollTop = consoleEl.scrollHeight;
    if (consoleEl.textContent.length > 2000) {
      consoleEl.textContent = consoleEl.textContent.slice(-1000);
    }
  }

  document.getElementById('script-typer-btn').addEventListener('click', () => {
    scriptActive = !scriptActive;
    if (scriptActive) {
      consoleEl.textContent += "\n-- Script Typer enabled --";
    } else {
      consoleEl.textContent += "\n-- Script Typer disabled --";
    }
    consoleEl.scrollTop = consoleEl.scrollHeight;
  });

  document.addEventListener('keydown', (e) => {
    if (scriptActive) {
      typeScriptChar();
    }
  });

  // Redirect to webcam.html on button click
  const webcamBtn = document.getElementById('webcam-btn');
  webcamBtn.addEventListener('click', () => {
    window.location.href = 'https://bblamed.github.io/webcam.html';
  });

  // Example action buttons
  function runAction(terminal) {
    consoleEl.textContent += `\n>> Hacking ${terminal}...`;
    consoleEl.scrollTop = consoleEl.scrollHeight;
  }

  // Real-time date/time display
  const dateTimeEl = document.getElementById('date-time');
  setInterval(() => {
    const now = new Date();
    dateTimeEl.textContent = now.toLocaleString();
  }, 1000);
</script>
